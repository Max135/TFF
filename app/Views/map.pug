extends navbar

block content

  body
    .row
      .col-9.m-0.p-0#mapContainer
        div#map
        script(nonce=nonce()).
            var hotspotFromPug = #{hotspots};
            mapboxgl.accessToken = 'pk.eyJ1Ijoid29vbnRvcG9saXMiLCJhIjoiY2tnYXoxMGVkMDgzMjJ2bTVqeTRrY2FuaiJ9.hg2PeuwIn4SPCMEFLt7mbw';
            var map = new mapboxgl.Map({
                container: 'map',
                style: 'mapbox://styles/mapbox/streets-v11',
                center: [-72.88, 45.62], // Long, Lat
                zoom: 8
            });

            map.on('load', function () {
                map.addSource('10m-bathymetry-81bsvj', {
                    type: 'vector',
                    url: 'mapbox://mapbox.9tm8dx88'
                });
                map.addLayer(
                    {
                        'id': '10m-bathymetry-81bsvj',
                        'type': 'fill',
                        'source': '10m-bathymetry-81bsvj',
                        'source-layer': '10m-bathymetry-81bsvj',
                        'layout': {},
                        'paint': {
                            'fill-outline-color': 'hsla(337, 82%, 62%, 0)',
                            // cubic bezier is a four point curve for smooth and precise styling
                            // adjust the points to change the rate and intensity of interpolation
                            'fill-color': [
                                'interpolate',
                                ['cubic-bezier', 0, 0.5, 1, 0.5],
                                ['get', 'DEPTH'],
                                200,
                                '#78bced',
                                9000,
                                '#15659f'
                            ]
                        }
                    },
                    'land-structure-polygon'
                );
                map.loadImage(
                    '/stylesheets/images/marker.png',
                    function (error, image) {
                        if (error) throw error;
                        var hotspotsInfo = JSON.parse(hotspotFromPug);
                        var hotspots = Object.keys(hotspotsInfo);
                        var hotspotsArray = hotspots.forEach(createHotspots)
                        map.addImage('custom-marker', image);
                        map.addSource('point', {
                            'type': 'geojson',
                            'data': {
                                'type': 'FeatureCollection',
                                'features': [
                                    {
                                        'type': 'Feature',
                                        'geometry': {
                                            'type': 'Point',
                                            'coordinates': [-72.88, 45.62]
                                        }
                                    },
                                    {
                                        'type': 'Feature',
                                        'geometry': {
                                            'type': 'Point',
                                            'coordinates': [-75.88, 45.62]
                                        }
                                    },
                                    {
                                        'type': 'Feature',
                                        'geometry': {
                                            'type': 'Point',
                                            'coordinates': [-72.88, 50.62]
                                        }
                                    }
                                ]
                            }
                        });
                        map.addLayer({
                            'id': 'symbols',
                            'type': 'symbol',
                            'source': 'point',
                            'layout': {
                                'icon-image': 'custom-marker',
                                'icon-size': 0.25
                            }
                        });
                        map.on('click', 'symbols', function (e) {
                            map.flyTo({
                                center: e.features[0].geometry.coordinates
                            });
                            location.pathname= '/hub'
                        });
                    }
                );
                // function createHotspots(item) {
                //     var hsotspot = {
                //         type : 'Feature',
                //         geometry: {
                //             type: 'Point',
                //             coordinates: [item.long, item.lat]
                //         }
                //     }
                //     console.log(hotspot);
                // }
            });

      .col-3.m-0.p-0#infoContainer
        .row.w-100.justify-content-center
          .h1#hotspotTitle="Hotspot"

        .row.justify-content-between
          span.hotspotCoord.p-0="Lat: 43.5675"
          span.hotspotCoord.p-0="Long: 69.4849"

        .row.justify-content-between.mt-2
          .justify-content-center.text-center
            i.fas.fa-fish.hotspotIcon
            br
            span="52"
          .justify-content-center.text-center
            i.fas.fa-drumstick-bite.hotspotIcon
            br
            span="60"
          .justify-content-center.text-center
            i.fa.fa-candy-cane.hotspotIcon.icon-flipped
            br
            span="75"

        br
        br
        .row.justify-content-center.m-2
          table(data-toggle='table' data-search='true' data-show-columns='true' data-pagination="true"
            data-side-pagination="server" data-page-list="[10, 25, 50, 100, 200, All]")
            thead
              tr.tr-class-1
                th(data-field='name' rowspan='2' data-valign='middle').grayColor Date
                th(data-field='star').text-right.grayColor Pressure
            tbody
              tr#tr-id-1.tr-class-1
                td#td-id-1.td-class-1 10 Novembre 2010
                td.text-right 8827
              tr#tr-id-2.tr-class-2
                td#td-id-2.td-class-1 10 Novembre 2010
                td.text-right 1615
              tr#tr-id-3.tr-class-3
                td#td-id-3.td-class-1 10 Novembre 2010
                td.text-right 220
              tr#tr-id-4.tr-class-4
                td#td-id-4.td-class-1 10 Novembre 2010
                td.text-right 1734
              tr#tr-id-5.tr-class-5
                td#td-id-5.td-class-1 10 Novembre 2010
                td.text-right 24
        br

        .row.justify-content-center
          .justify-content-center.text-center
            a(href="/winds")
              i.fas.fa-wind.windIcon
              br
            span#windIndicator="55 mph"

